<script>
    async function initComment(){
        var initOptions = Object.assign(
            <%- JSON.stringify(theme.twikoo || {}) %>,
            {
                el: '#comment',
                onCommentLoaded: function() {
                    //
                }
            }
        )
        await twikoo.init(initOptions)
        <% if(is_post()){ %>
            var countOptions = Object.assign(
                <%- JSON.stringify(theme.twikoo || {}) %>,
                {
                    urls: [window.location.pathname],
                    includeReply: false
                }
            )
            const res = await twikoo.getCommentsCount(countOptions)
            try{
                document.getElementById('twikoo-count').innerText = res[0].count
            }catch (e) {
                document.getElementById('twikoo-count').innerText = '加载错误'
            }
        <% } %>
    }
</script>
